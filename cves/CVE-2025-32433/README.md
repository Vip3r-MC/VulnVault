# CVE-2025-32433: Erlang SSH Server Pre-Authentication Command Execution

![Header Image Placeholder](img/header.png)

## Overview
This repository contains a proof-of-concept (PoC) for CVE-2025-32433, a vulnerability in the Erlang SSH server implementation that allows for pre-authentication command execution. The vulnerability affects Erlang/OTP versions 26.2.5.10 and potentially earlier versions.

## Technical Details
The vulnerability exists in the Erlang SSH server implementation, specifically in the handling of SSH connections and authentication mechanisms. The server accepts and processes SSH_MSG_CHANNEL_REQUEST messages before authentication is completed, allowing for arbitrary command execution.

### Affected Versions
- Erlang/OTP 26.2.5.10
- Potentially earlier versions

### Vulnerability Type
- Pre-authentication Command Execution
- CWE-306: Missing Authentication for Critical Function

## Setup Instructions

### Prerequisites
- üêç Python 3.x
- üê≥ Docker
- üê≥ Docker Compose

### Building the Vulnerable Environment
```bash
# Clone the repository
git clone https://github.com/yourusername/CVE-2025-32433.git
cd CVE-2025-32433

# Build and start the vulnerable server
docker-compose up --build
```

The vulnerable SSH server will be accessible on port 2222.

## Testing the Vulnerability

### Using the Python Exploit
```bash
# Install required dependencies
pip install colorama

# Basic test
python3 CVE-2025-32433.py

# Test with specific command
python3 CVE-2025-32433.py -c 'os:cmd("uname -a").'

# Test with verbose output
python3 CVE-2025-32433.py -v

# Test with pre-defined commands
python3 CVE-2025-32433.py -w  # whoami
python3 CVE-2025-32433.py -i  # id
python3 CVE-2025-32433.py -l  # ls -la
python3 CVE-2025-32433.py -pwd  # pwd
```

### Command Line Options
- `-H, --host`: Target host (default: localhost)
- `-p, --port`: Target port (default: 2222)
- `-t, --timeout`: Connection timeout in seconds (default: 5)
- `-v, --verbose`: Enable verbose output
- `-c, --command`: Custom command to execute
- `-w, --whoami`: Execute whoami command
- `-i, --id`: Execute id command
- `-l, --ls`: Execute ls command
- `-pwd, --pwd`: Execute pwd command

## Expected Behavior
- The SSH server should accept connection attempts
- The server will process commands before authentication
- All commands will be executed with the privileges of the Erlang process
- The server will respond with command output or error messages

## Mitigation
- Update to the latest version of Erlang/OTP
- Implement proper authentication checks before processing commands
- Restrict SSH access to trusted networks only
- Monitor for unauthorized access attempts

## Disclaimer
This PoC is provided for educational and research purposes only. Use it responsibly and only in controlled environments. The authors are not responsible for any misuse or damage caused by this code.

## References
- [CVE-2025-32433 Details](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-32433)
- [Erlang/OTP Security Advisory](https://www.erlang.org/security)
- [Original PoC](https://platformsecurity.com/blog/CVE-2025-32433-poc)

## License
This PoC is released under the MIT License. See the LICENSE file for details. 